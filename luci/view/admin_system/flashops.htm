<%#
LuCI - Lua Configuration Interface
Copyright 2008 Steven Barth <steven@midlink.org>
Copyright 2008 Jo-Philipp Wich <xm@leipzig.freifunk.net>

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

	http://www.apache.org/licenses/LICENSE-2.0

$Id: flashops.htm 7798 2011-10-26 23:43:04Z jow $

-%>

<%+header%>

<fieldset class="cbi-section">
		<form method="post" action="<%=REQUEST_URI%>" enctype="multipart/form-data">
			<div class="cbi-section-descr" style="font-size:20px"><%:Restore%></div>
			<div class="cbi-section-node">
				<div class="cbi-value cbi-value-last">
					<label class="cbi-value-title" for="archive"><%:Restore backup%>:</label>
					<div class="cbi-value-field">
						<input type="file" name="archive" id="archive" />
						<div>
						<input type="submit" class="cbi-button cbi-input-reset" name="restore" value="<%:Upload%>" />
						</div>
					</div>
				</div>
			</div>
		</form>
		<% if reset_avail then %>
		<form method="post" action="<%=REQUEST_URI%>" enctype="multipart/form-data">
			<div class="cbi-section-descr" style="font-size:20px"><%:Reset%></div>
			<div class="cbi-section-node">
				<div class="cbi-value cbi-value-last">
					<label class="cbi-value-title"><%:Reset to defaults%>:</label>
					<div class="cbi-value-field">
						<input onclick="return confirm('<%:Really reset all changes?%>')" class="cbi-button cbi-button-reset" type="submit" name="reset" value="<%:Perform reset%>" />
					</div>
				</div>	
			</div>
		</form>
		<% end %>

		<% if upgrade_avail then %>
			<form method="post" action="<%=REQUEST_URI%>" enctype="multipart/form-data">
				<div class="cbi-section-descr" style="font-size:20px"><%:Flash new firmware image%></div>
				<div class="cbi-section-node">
					<div class="cbi-value">
						<label class="cbi-value-title" for="keep"><%:Keep settings%>:</label>
						<div class="cbi-value-field">
							<input class="cbi-input-checkbox" type="checkbox" name="keep" id="keep" checked="checked" />
						</div>
					</div>
					<div class="cbi-value cbi-value-last<% if image_invalid then %> cbi-value-error<% end %>">
						<label class="cbi-value-title" for="image"><%:Image%>:</label>
						<div class="cbi-value-field">
							<input type="file" name="image" id="image" accept = ".bin,.zip" />
						<div>
							<input type="submit" class="cbi-button cbi-input-reset" value="<%:Flash%>" />
						</div>
						</div>
					</div>
				</div>
				<% if image_invalid then %>
					<div class="cbi-section-error"><font color = "red"><%:The uploaded image file does not contain a supported format. Make sure that you choose the generic image format for your platform. %></font></div>
				<% end %>
			</form>
		<% else %>
			<div class="cbi-section-descr"><font color = "red"><%:Sorry, there is no sysupgrade support present, a new firmware image must be flashed manually. Please refer to the OpenWrt wiki for device specific install instructions.%></font></div>
		<% end %>
	</fieldset>

<%+footer%>
